<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- JAVA와 연결할 Mapper 파일 설정 -->
<mapper namespace="poly.persistance.mapper.IMyPageMapper">

   <!-- 게시판 리스트 쿼리 -->
   <select id="getgalList" resultType="MyPageDTO">
      SELECT 
      G.gal_nb, 
      G.file_name,
      G.gal_name, 
      G.reg_dt, 
      G.email,
      G.gal_rep, 
      G.gal_content, 
      U.my_nb,U.MY_CONTENT
      FROM 
      GALTABLE G ,USER_INFO U 
      WHERE 
      U.email = G.EMAIL or G.EMAIL='root' and G.gal_nb>='0'ORDER BY G.gal_nb DESC
   </select>

   <!-- 게시판 새글 등록 쿼리 -->
   <insert id="insertFile" parameterType="MyPageDTO">
      INSERT INTO GALTABLE(
      gal_nb, 
      email, 
      gal_name, 
      gal_content,
      file_content,
      file_name, gal_rep
      )
      VALUES(
      gal_seq.nextval, 
      #{email}, 
      #{gal_name},
      #{gal_content}, 
      #{file_content}, 
      #{file_name}, 
      #{gal_rep}
      )
   </insert>
   
   <!--  개인 게시판 번호 최신화 쿼리 -->
   <update id="UpDateMynb" parameterType="UserInfoDTO">
      UPDATE USER_INFO
      SET
      my_nb=my_nb+1
      WHERE
      email = #{email}
   </update>
   
   <!-- 상태글 새글 등록 쿼리 -->
   <update id="UpdateState" parameterType="UserInfoDTO">
      UPDATE USER_INFO
      SET
      my_content=#{my_content}
      where
      email = #{email}
   </update>

   <select id="getGalDetail" parameterType="MyPageDTO"
      resultType="MyPageDTO">
      SELECT 
      gal_nb, 
      gal_name, 
      gal_content,
      file_name
      FROM 
      GALTABLE 
      WHERE
      gal_nb = #{gal_nb}
   </select>
   
   <!--초기 게시판 새글 등록 쿼리(디폴트값으로 만들어두자)
   <insert id="insertFirst" parameterType="MyPageDTO">
      INSERT INTO GALTABLE(
      GAL_NB, USER_ID, GAL_NAME, GAL_CONTENT,
      FILE_CONTENT,
      FILE_NAME, GAL_REP
      )
      VALUES(
      0,'root','초기게시판','초기게시판', 'C:\\hanium-space\\MyC\\WebContent\\fileFolder\\main.png', 'main.png',1
      )
   </insert>-->

   <!--<update id="getupdatePost" parameterType="BoardDTO"> UPDATE BOARD SET 
      POST_TITLE=#{POST_TITLE}, POST_CONTENT=#{POST_CONTENT} WHERE POST_NO=#{POST_NO} 
      </update> -->

   <!-- 개인 사진 쿼리 <select id="filenotice" resultType="MyPageDTO"> SELECT G.file_name, 
      G.gal_rep, FROM GALTABLE G, USER_INFO U where G.user_id = u.user_id </select> -->

   <!-- 회원가입 <insert id="userinsert" parameterType="USERDTO"> INSERT INTO USER_INFO( 
      user_id,seq,user_name,password,emall,addr1,addr2 ) VALUES( #{user_id},USER_seq.nextval,#{user_name},#{password},#{email},#{addr1},#{addr2} 
      ) </insert> -->
</mapper>